# PassageRanking

To run bm25 on an input set, use the command bellow in the root folder, changing the index, topics and output accordingly
```
python -m pyserini.search  --index indexes/sample_collection_jsonl \
--topics data/msmarco-test2019-queries.tsv \
--output run.sample.txt  \
--bm25 
```

To run the trec_eval evaluation tool, first transform the output of the bm25 to trec format using:
```
python -m pyserini.eval.convert_msmarco_run_to_trec_run \
   --input runs/run.msmarco-passage.bm25tuned.txt \
   --output runs/run.msmarco-passage.bm25tuned.trec
  ```

Then, this new file can be used to apply trec_eval using the following command:
```
tools/eval/trec_eval.9.0.4/trec_eval -c -mrecall.1000 -mmap \
   collections/msmarco-passage/qrels.dev.small.trec \\
    runs/run.msmarco-passage.bm25tuned.trec
```
The second line in the command being the actual query relevance document
The third line in the command being the transformed output of bm25

(more info at: https://github.com/castorini/pyserini/blob/master/docs/experiments-msmarco-passage.md)


## Assignment steps
To run the data set, perform the following steps:
* Download trec_eval
* Read information about trec_eval on http://www.rafaelglater.com/en/post/learn-how-to-use-trec_eval-to-evaluate-your-information-retrieval-system
* Index the data collection
* Run the ranking method with the command below.  
```
python -m pyserini.search  --index indexes/sample_collection_jsonl \
--topics data/msmarco-test2019-queries.tsv \
--output runs/run.sample.txt  \
--bm25 
```
* The output file has the following format: (query-id Q0 document-id rank score STANDARD)
* Evaluate the results by running the command below. The q_rels document needs to have the following format (query-id 0 document-id relevance)
``` 
sudo trec_eval -q -m map -m P.10,100  qrels/qrels.dev.tsv runs/run.queries.dev.txt >> eval.txt 
```
* The output file has the following format (measure query-id score)


## Error analysis
The following steps have been retrieved from the template in the referenced document in the assignement. For the error analysis, the worst categorized topics have been examined in detail.
The queries getting the lowest precision in the first 100 passages retrieved can be seen in table 1. 

| Query ID | Query text                                                      | P_100 score |
|----------|-----------------------------------------------------------------|-------------|
| 1000000  | where does real insulin come from                               | 0.0         |
 | 1000003  | where does parrot live                                          | 0.0         |
 | 1000006  | where does most of the iron ore come from                       | 0.0         |
 | 1000012  | where is weston, fl                                             | 0.0         |
 | 1000016  | where does most coal form                                       | 0.0         |
 | 1000025  | where is westworld filmed?                                      | 0.0         |
 | 1000054  | where is whistler bc                                            | 0.0         |
 | 100007   | cortana what is magnetic                                        | 0.0         |
 | 1000085  | where does it hurt for sciatica                                 | 0.0         |
 | 1000101  | where does galicia come from                                    | 0.0         |
 | 1000102  | where does erosion and deposition occur                         | 0.0         |
 | 1000107  | where is whitney houston's  awards after she died               | 0.0         |
 | 1000117  | where does catnip grow in the wild?                             | 0.0         |
 | 100013   | cortana what is the apocalypse                                  | 0.0         |
 | 1000149  | where does blood flow after leaving the heart's right ventricle | 0.0         |
 | 100020   | cortana what is the date of the eclipse                         | 0.0         |
 | 1000233  | define: optimum                                                 | 0.0         |
 | 1000234  | where does a bunion hurt                                        | 0.0         |
 | 1000258  | where do you measure waist for jeans                            | 0.0         |
 | 1000266  | where do yetis come from                                        | 0.0         |

### Behavior on top relevant documents 
[How many of the top documents for this system were relevant and could they be categorized and distinguished from others?]

| Query ID | Count in top | Locations | Document ID |
|----------|--------------|-----------|-------------|
| 1000000  | 0            | -         |
| 1000003  | 0            | -         |
| 1000006  | 0            | -         |
| 1000012  | 0            | -         |
| 1000016  | 1            | 99        | 7264249     |
| 1000025  | 0            | -         |
| 1000054  | 0            | -         |  
| 100007   | 0            | -         |
| 1000085  | 0            | -         |
| 1000101  | 0            | -         |
| 1000102  | 0            | -         |
| 1000107  | 0            | -         |
| 1000117  | 0            | -         |
| 100013   | 0            | -         |
| 1000149  | 0            | -         |
| 100020   | 0            | -         |
| 1000233  | 0            | -         |
| 1000234  | 0            | -         |
| 1000258  | 0            | -         |
| 1000266  | 0            | -         |

### Behavior on top non-relevant documents 
[Why were the top non-relevant documents retrieved?]
Looking at the top 5 documents retrieved for the first 10 queries

| Query ID | document_id | Reason                                                 | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                        
|----------|-------------|--------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1000000  | 2036924     | keyword appears often, but text is about other subject | Diabetes is a disease in which your blood glucose, or blood sugar, levels are too high. Glucose comes from the foods you eat. Insulin is a hormone that helps the glucose get into your cells to give them energy. With type 1 diabetes, your body does not make insulin. With type 2 diabetes, the more common type, your body does not make or use insulin well. Without enough insulin, the glucose stays in your blood.                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 1000000  | 2637713     | keyword appears often, but text is about other subject | Best Answer: Your pancreas controls the insulin in your body. Type 1 diabetes is where you are born with it, but your pancreas does not work and your are insulin dependent.Type 2 diabetes your pancreas works but needs help by injecting insulin to provide what your body does not make.Or taking a pill or controling it by food if you are border line.Source(s):ype 1 diabetes is where you are born with it, but your pancreas does not work and your are insulin dependent. Type 2 diabetes your pancreas works but needs help by injecting insulin to provide what your body does not make. Or taking a pill or controling it by food if you are border line. Source(s):                                                                                                                                                             |
| 1000000  | 8533188     | keyword appears often, but text is about other subject | What Happens During an Insulin Overdose? Diabetes is a condition in which your body does not produce enough insulin or your cells do not utilize the insulin properly. Insulin is vital to the body's function, but too much insulin can be dangerous. Insulin is produced in the pancreas. Insulin moves glucose from the body's bloodstream into the cells, where it can be used for energy. Paired with a healthy diet and exercise, insulin can help individuals with diabetes live a full and active life.                                                                                                                                                                                                                                                                                                                                |
| 1000000  | 21000       | keyword appears often, but text is about other subject | Descriptions. Metformin is used to treat high blood sugar levels that are caused by a type of diabetes mellitus or sugar diabetes called type 2 diabetes. With this type of diabetes, insulin produced by the pancreas is not able to get sugar into the cells of the body where it can work properly.etformin does not help patients does not help patients who have insulin-dependent or type 1 diabetes because they cannot produce insulin from their pancreas gland. Their blood glucose is best controlled by insulin injections.                                                                                                                                                                                                                                                                                                        |
| 1000000  | 6295390     | duplicate of document 21000                            | descriptions metformin is used to treat high blood sugar levels that are caused by a type of diabetes mellitus or sugar diabetes called type 2 diabetes with this type of diabetes insulin produced by the pancreas is not able to get sugar into the cells of the body where it can work properlyetformin does not help patients does not help patients who have insulin dependent or type 1 diabetes because they cannot produce insulin from their pancreas gland their blood glucose is best controlled by insulin injections                                                                                                                                                                                                                                                                                                              |
| 1000003  | 4402681     | keyword is used as an example                          | Note in these examples how the subject-verb relationship has changed. Because the subject is being acted upon (or is passive), such sentences are said to be in the passive voice. NOTE: Colorful parrots live in the rainforests cannot be changed to passive voice because the sentence does not have a direct object.ote in these examples how the subject-verb relationship has changed. Because the subject is being acted upon (or is passive), such sentences are said to be in the passive voice. NOTE: Colorful parrots live in the rainforests cannot be changed to passive voice because the sentence does not have a direct object.                                                                                                                                                                                                |
| 1000003  | 6235548     | Answers the how long question                          | It depends on the type of parrot. Some parrot species can live up to 80 years, but smaller species may live only 15 to 20 years.n African Grey, with the right care, can live 60+ years. Most parrots are very long-lived, with even budgies living to more than 15 years. an African grey parrot can live for â¦ 100 years. 5 people found this useful.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 
| 1000003  | 2088926     | Should be a relevant document                          | HABITAT AND DIET. Most parrots live in warm climates, although not all: thick-billed parrots, maroon-fronted parrots, and keas live in snowy alpine areas and are even referred to as snow birds. Parrots that don't live in areas with trees use cacti, termite mounds, or rocky outcrops to make their home.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                    |
| 1000003  | 4541590     | Has a lot of the key word occurences                   | â¢ Quakers are known by several different names. While they are most commonly referred to as Quaker parrots, these birds are often referred to by a variety of different names. In addition to their most common moniker, these birds are often called Quaker parakeets, Monk parrots, and Monk parakeets. Quaker parrots can live for a very long time. Like many parrot species, Quaker parrots can enjoy a particularly long lifespan in captivity. In fact, when well taken care of, some Quaker parrots can live in excess of 30 years.                                                                                                                                                                                                                                                                                                  |
| 1000003  | 8542069     | Answers the how long question                          | Oldest parrot living. Share. This record is based on the age of a fully grown, adult, living parrot. The age must be measured in years and days. This record is based on the age of a fully grown, adult, living parrot. The age must be measured in years and days.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 
| 1000006  | 4092298     | Contains key words                                     | Like many metals, aluminium does not come out of the ground as a shiny metal, but as a special kind of rock, an ore. Aluminium ore is called bauxite. It is also quite a valuable metal as it is hard to get the aluminium from the ore.luminium can be recycled indefinitely (over and over again), as the recycling process does not affect the quality of the metal. It takes around 6 weeks from the time an aluminium can is put in a recycling bin to be back in a shop filled with new drink.                                                                                                                                                                                                                                                                                                                                           |
 | 1000006  | 4697766     | Contains key word but does not answer the question     | Bog iron ore, Iron ore consisting of hydrated iron oxide minerals such as limonite and goethite formed by precipitation of groundwater flowing into wetlands. Bacterial action contributes to formation of the ore. Economically useful deposits can regrow within 20 years after harvesting.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 1000006  | 2912100     | key words are used in different context                | Iron compounds are essential to all life. For example, it is an iron atom in haemoglobin that is responsible for carrying oxygen around the blood stream. Iron is not found as the free metal in nature. The most common ore is haematite (iron oxide, Fe203).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 1000006  | 1603793     | Does contain one of the key words                      | 1 Although it is a rare natural element, actinium does occur in uranium ores, where it forms from the radioactive decay of uranium and other radioisotopes, such as radium. 2  Although it is found in ores, actinium is not commercially extracted from minerals. 3  36 isotopes of actinium are known -- all radioactive.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 1000012  | 8587400     | List random info that contains the adres               | Richest / Poorest Cities by Income in FL. Expensive / Cheapest Homes by City in FL. Most / Least Educated Cities in FL. The average temperature of Weston is 75.48Â°F, which is higher than the Florida average temperature of 71.80Â°F and is much higher than the national average temperature of 54.45Â°F.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 10000012 | 7994375     | List a location that contains the adres                | eston, Fl 33326. (954) 389-2010 (non-emergency) In addition to unincorporated areas of western Broward County, the district serves the City of Weston. The geographical boundaries of the district are I-75 to the east, Collier County line to the west, Griffin Road to the south and Interstate I-595/I-75 to the north.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 10000012 | 2037629     | List a location that contains the adres                | Hotels near Cleveland Clinic Florida. Find hotels near Cleveland Clinic Florida in Weston FL on Hotels-Rates.com. Many of these Weston hotels are within a short distance of Cleveland Clinic Florida. 1-25 of 75 Hotels within 13.0 miles of Cleveland Clinic Florida. Hotels closest to Cleveland Clinic Florida are listed first.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 10000012 | 7497019     | List a location that contains the adres                | April 18, 2017. 7:30pm @ Weston Municipal Center...[Click for more] The Town of Weston is located just east of Wausau in Marathon County where the Eau Claire River meets the Wisconsin River. The town of Eau Claire was formed in 1856 and changed to Weston in February of 1859. We are where the city meets the country. The Township that remains after the incorporation of the Village of Weston in 1997 is the northern 1/3 of the original Township, consisting of 9 square miles with 19 miles of roads, and a little over 600 residents.                                                                                                                                                                                                                                                                                            |
| 10000012 | 8572663     | List a location that contains the adres                | Jockey Cir N, Fort Lauderdale, FL. Coldwell Banker Residential Real Estate - Weston                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 10000016 | 648390      | Answers the how question                               | Organic material such as plants, are under extreme pressure and several hundred years late coal forms. How Does Coal Form. Coal is formed from organic remains, which were buried, burial led to compression, and compression led to a sedimentary rock forming.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 10000016 | 1980014     | comparison with a different item                       | Why is Coal not classified as a Mineral? July 8, 2011, shiela, Leave a comment. Why is Coal not classified as a Mineral? Coal is not a mineral because it does not qualify to be one. A mineral is made of rocks. It is non-living and made up of atoms of elements. Coals on the other hand are carbon-based and came from fossilized plants. By just looking into the origin of coals, these are not qualified to be minerals because they come from organic material and it has no definite chemical composition. Minerals are not formed from living things such as plants or animals. They are building blocks of rocks and are formed thousands of years ago. Coals on the other hand came from dead plants and animals. The coals are formed when these living creatures will decay. Again, it takes thousands of years to form a coal. |
| 10000016 | 7059852     | In a differnet context                                 | Oil is a liquid fossil fuel that is formed from the remains of marine microorganisms deposited on the sea floor. After millions of years the deposits end up in rock and sediment where oil is trapped in small spaces. It can be extracted by large drilling platforms. Oil is the most widely used fossil fuel.here are three types of fossil fuels which can all be used for energy provision; coal, oil and natural gas. Coal is a solid fossil fuel formed over millions of years by decay of land vegetation. When layers are compacted and heated over time, deposits are turned into coal.                                                                                                                                                                                                                                             |
| 10000016 | 1524408     | Different context                                      | 	Longwall mining is a form of underground coal mining where a long wall of coal is mined in a single slice (typically 0.6 â 1.0 m thick).y 1940, some referred to longwall mining as the conveyor method of mining, after the most prominent piece of machinery involved. Unlike earlier longwall mining, the use of a conveyor belt parallel to the coal face forced the face to be developed along a straight line.                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 10000016 | 1524410     | similar to document 1524408                            | From Wikipedia, the free encyclopedia. Longwall mining. Longwall mining is a form of underground coal mining where a long wall of coal is mined in a single slice (typically 0.6 â 1.0 m thick). The longwall panel (the block of coal that is being mined) is typically 3 â 4 km long and 250 â 400 m wide.y 1940, some referred to longwall mining as the conveyor method of mining, after the most prominent piece of machinery involved. Unlike earlier longwall mining, the use of a conveyor belt parallel to the coal face forced the face to be developed along a straight line.                                                                                                                                                                                                                                                 |


### Behavior on unretrieved relevant documents 
[Why weren’t these relevant documents retrieved within the top 100?]

| Query ID | document_id | Reason                               | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                        
|----------|-------------|--------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1000000  | 7264308     | ?                                    | Insulin (from the Latin, insula meaning island) is a peptide hormone produced by beta cells of the pancreatic islets, and it is considered to be the main anabolic hormone of the body.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 1000003  | 7264269     | keyword does not appear often enough | Parrots live in just about all of the tropical climate zones around the world, showing up in Central and South America, southern Africa, south Asia and Australia. There are more than 350 different... Star Gazing                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 1000006  | 7264253     | ?                                    | Earth's most important iron ore deposits are found in sedimentary rocks. They formed from chemical reactions that combined iron and oxygen in marine and fresh waters. The two most important minerals in these deposits are iron oxides: hematite (Fe2O3) and magnetite (Fe3O4).                                                                                                                                                                                                                                                                                                                                                                                        |
| 1000012  | 7942175     | ?                                    | Weston, Florida. Weston is a suburban community in Broward County, Florida, United States. Established as a city in 1996, much of the community was developed by Arvida/JMB Realty and is located near the western developmental boundary of Broward County. It is the most western city in Broward County, and its entire west side is next to the Everglades.                                                                                                                                                                                                                                                                                                          |
| 1000016  | 7264249     | ?                                    | America is the Saudi Arabia of Coal Plant fossils of West Virginia are examples of the fossil flora that comprise the vast coal reserves that are typical in the Eastern United States. Coal is formed from ancient plant material accumulating over long periods of time in swamp conditions so devoid of oxygen that bacteria could not exist to cause decay. Being composed almost entirerly of plant fossils, coal is in effect concentrated sunlight, and is one of our most important fossil fuels. The United States as a whole has more recoverable coal resources than any other country on the planet-- over 262 billion tons-- enough to last over 200 years! |

### Beadplot observations 
[How does the ranking (especially among the top 50 documents) of this system compare to all other systems?]

### Base Query observations 
[What did the system think were the important terms of the original query, and were they good?]
### Expanded Query observations 
[If the system expanded the query (4 out of 6 systems did), what were the important terms of the expansion, and were they helpful?]
### Blunders of system 
[What obvious mistakes did the system make that it could have easily avoided? Examples might be bad stemming of words or bad handling of hyphenation]

### Other features of note 
[Anything else.]

### What should system to do improve performance? 
[The individual’s conclusion as to why the system did not retrieve well, and recommendations as to what would have made a better retrieval.]
### What added information would help performance? How can system get that information? 
[Is there implicit information in the query, that a human would understand but the system didn’t? Examples might be world knowledge (like Germany is part of Europe).]
### Assessing agreement (were there major issues? was relevance determined by “Desc”?) 
[The NIST assessor who originally judged relevance of documents might have a different idea of what was relevant than the text of the description indicates or than the workshop participant thinks should be relevant. It also may be unclear where and why the NIST assessor drew the line between marginally relevant and non-relevant] 